---------------Below Analysis was done on Hive Tool on Haddop--------------------------------

create table airport(
airport_id int,
name string,
city string,
country string,
iata string,
icao string,
latitude double,
longitude double,
altitude int,
timezone double,
dst string,
tz string)
row format delimited
fields terminated by ','
stored as textfile;

load data local inpath 'airports_mod.dat' overwrite into table_airport;4

create table airlines(
airline int,
name string,
alias string,
iata string,
icao string,
callsign string,
country string,
active string
)
row format delimited 
fields terminated by ','
stored as textfile;

load data local inpath 'Final_airlines' overwrite into table airlines;


create table routes(
airline string,
airline_id int,
source_airport string,
source_airport_id int,
destination_airport string,
destination_airport_id int,
codeshare string,
stops int,
equipment string)
row format delimited
fields terminated by ','
stored as textfile;


load data local inpath 'routes.dat' overwrite into table routes;


airport 8107 rows
airline 6048 rows
routes 67663 rows


A. Find list of Airports operating in the Country India


select name from airport 
where country="India"

There are a total of 140 Airports Operating in India

B.	Find the list of Airlines having zero stops

select distinct a.airline , a.name
from airlines a
left outer join routes r 
on a.airline = r.airline_id
where r.stops = 0;


There are a total of 540 Airlines having zero stops

C.	List of Airlines operating with code share


select distinct a.airline , a.name
from airlines a
left join routes r
on a.airline = r.airline_id
where r.codeshare = "Y";


There are a total of 146 Airlines operating with code share agreement.

D.	Which country (or) territory having highest Airports


select country , count(*) as total_airport
from airport
group by country
order by total_airport desc
limit 5;

United States has 1697 airport which is at top


E.	Find the list of Active Airlines in United States


select distinct a.airline , a.name , arp.country
from routes r
left outer join airlines a
on a.airline = r.airline_id
left outer join airport arp
on r.source_airport_id = arp.airport_id
where a.iata in (select r1.airline from routes r1) and
arp.country = "United States";

There are 134 Active Airlines operating in the country.

















